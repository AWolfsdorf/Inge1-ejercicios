

----STARTUP---- (24 June 2021 21:36:33) as /home/nikita/r/f/ingsoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!


----End fileIn of /home/nikita/r/f/ingsoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/Tus-Libros.st----!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'nz 6/24/2021 21:37:27'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'nz 6/24/2021 21:38:02'!
PASSED!
!CheckOutTest methodsFor: 'setUp/tearDown' stamp: 'nz 6/24/2021 21:38:37' prior: 50331895 overrides: 16927572!
setUp

	today _ FixedGregorianDate today.
	currentMonth _ today monthOfYear.
	
	creditCardNumber _ '4182418241824182'.
	cardOwner _ 'PEPE SANCHEZ'.

	stubs := TestStubs new.

	validCreditCard _ CreditCard
		number: creditCardNumber
		owner: cardOwner
		expiration: currentMonth next.
	
	expiredCreditCard _ CreditCard
		number: creditCardNumber
		owner: cardOwner
		expiration: currentMonth previous.
		
	expiredThisMonthCreditCard _ CreditCard
		number: creditCardNumber
		owner: cardOwner
		expiration: currentMonth.
		
	invalidNumberCreditCard _ stubs invalidNumberCreditCard.
		
	emptyOwnerCreditCard _ CreditCard
		number: creditCardNumber
		owner: ''
		expiration: currentMonth next.
		
	emptyOwnerCreditCard2 _ CreditCard
		number: creditCardNumber
		owner: '            '
		expiration: currentMonth next.
		
	book1 := stubs book1.
	book2 := stubs book2.
	
	mockAlwaysStolenCardMerchantProcessor _ MockAlwaysStolenCardMerchantProcessor new.
	mockAlwaysOkMerchantProcessor _ stubs mockAlwaysOkMerchantProcessor.
	mockAlwaysFakeCardMerchantProcessor _ MockAlwaysFakeCardMerchantProcessor new.
	mockAlwaysWithoutCreditCardMerchantProcessor _ MockAlwaysWithoutCreditCardMerchantProcessor new.! !

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'nz 6/24/2021 21:38:50'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'nz 6/24/2021 21:38:51'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'nz 6/24/2021 21:38:52'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'nz 6/24/2021 21:38:53'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'nz 6/24/2021 21:38:53'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'nz 6/24/2021 21:38:53'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'nz 6/24/2021 21:38:53'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'nz 6/24/2021 21:38:54'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'nz 6/24/2021 21:38:54'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'nz 6/24/2021 21:38:54'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'nz 6/24/2021 21:38:54'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'nz 6/24/2021 21:38:54'!
PASSED!

----End fileIn of /home/nikita/r/f/ingsoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/StringsServicesServer.st----!

ssri := StringsServicesRestInterface listeningOn: 8080.!

Smalltalk allObjectsDo: [
	:obj |
	(obj isKindOf: StringsServicesRestInterface)
	ifTrue: [ obj stopListening. ]
].!


servers : OrderedCollection new.!


servers := OrderedCollection new.!

Smalltalk allObjectsDo: [
	:obj |
	(obj isKindOf: StringsServicesRestInterface)
	ifTrue: [ servers add: obj. ]
].!

servers!


servers do: [ :srv | srv stopListening ].!


servers do: [ :srv | srv destroy ].!

servers := OrderedCollection new.
!


Smalltalk allObjectsDo: [
  :obj |
  (obj isKindOf: StringsServicesRestInterface)
  ifTrue: [ servers add: obj. ]
].!

servers!

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'nz 6/24/2021 22:13:15'!
PASSED!

----QUIT----(24 June 2021 22:13:29) CuisUniversity-4532.image priorSource: 18058935!

----STARTUP---- (27 June 2021 22:23:03) as /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!


Object subclass: #TusLibrosRestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

!classDefinition: #TusLibrosRestInterface category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:31:33'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'webServer port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

!classDefinition: #TusLibrosRestInterface category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:31:51'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'webServer port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!
!TusLibrosRestInterface class methodsFor: 'no messages' stamp: 'AW 6/27/2021 22:32:38'!
on: aPort! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:33:46' prior: 50333994!
on: aPort

	^self new withPort: aPort! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:34:16' prior: 50333998!
on: aPort

	^self new initializeOn: aPort! !
!TusLibrosRestInterface methodsFor: 'nil' stamp: 'AW 6/27/2021 22:36:08'!
initializeOn: aPort

	port := aPort.
	
	webServer := WebServer new listenOn: self port.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:37:13'!
port

	^port ifNil: [ port _ 8080].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:37:37' prior: 50334007!
initializeOn: aPort

	port := aPort.
	
	webServer := WebServer new listenOn: self port.
	
	self configRoutes.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:43:07'!
configRoutes

	self addService: '/sayHello' action: [ :request | request send200Response: 'Que ondas' ].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:44:24'!
addService: aRouteString action: aBlockClosure

	webServer addService: aRouteString action: aBlockClosure.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:44:56'!
destroy
	webServer ifNotNil: [ webServer destroy ].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:45:09'!
startListening
	webServer startListener.
	^ 'Listening on port: ' , self port asString.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:45:14'!
stopListening
	webServer stopListener.
	^ 'Stopped listening from port: ' , self port asString.! !

tusLibrosWebServer _ TusLibrosRestInterface on: 8080.!

tusLibrosWebServer startListening.!

tusLibrosWebServer stopListening !

tusLibrosWebServer destroy !

tusLibrosWebServer destroy.!

stubs _ TestStubs new. !

!classDefinition: #ShopConfiguration category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:55:12'!
Object subclass: #ShopConfiguration
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!


shopConfiguration _ ShopConfiguration 
		withUserAuthenticator: (stubs mockUserAuthenticatorAlwaysReturning: false)
		prices: stubs priceList
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor
		timeProvider: stubs timeProvider.!
!TestStubs methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:55:35'!
mockUserAuthenticatorAlwaysReturning: aFalse 
	self shouldBeImplemented.! !
!TestStubs methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:55:51' prior: 50334077!
mockUserAuthenticatorAlwaysReturning: aFalse 
	MockUserAuthenticator alwaysReturning: false.! !
!TestStubs methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:56:07' prior: 50334083!
mockUserAuthenticatorAlwaysReturning: aBoolean
	^MockUserAuthenticator alwaysReturning: aBoolean.! !
!ShopConfiguration class methodsFor: 'instance creation' stamp: 'AW 6/27/2021 22:56:18'!
withUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMockAlwaysOkMerchantProcessor timeProvider: aMockTimeProvider 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMockAlwaysOkMerchantProcessor timeProvider: aMockTimeProvider ! !
!ShopConfiguration class methodsFor: 'instance creation' stamp: 'AW 6/27/2021 22:56:44' prior: 50334095!
withUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMockAlwaysOkMerchantProcessor timeProvider: aMockTimeProvider 


	^self new initializeWithUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMockAlwaysOkMerchantProcessor timeProvider: aMockTimeProvider ! !
!ShopConfiguration class methodsFor: 'instance creation' stamp: 'AW 6/27/2021 22:56:52' prior: 50334112!
withUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMockAlwaysOkMerchantProcessor timeProvider: aTimeProvider 


	^self new initializeWithUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMockAlwaysOkMerchantProcessor timeProvider: aTimeProvider ! !
!ShopConfiguration class methodsFor: 'instance creation' stamp: 'AW 6/27/2021 22:57:04' prior: 50334126!
withUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMerchantProcessor timeProvider: aTimeProvider 


	^self new initializeWithUserAuthenticator: aMockUserAuthenticator prices: aPriceList merchantProcessor: aMerchantProcessor timeProvider: aTimeProvider ! !
!ShopConfiguration class methodsFor: 'instance creation' stamp: 'AW 6/27/2021 22:57:11' prior: 50334140!
withUserAuthenticator: aUserAuthenticator prices: aPriceList merchantProcessor: aMerchantProcessor timeProvider: aTimeProvider 


	^self new initializeWithUserAuthenticator: aUserAuthenticator prices: aPriceList merchantProcessor: aMerchantProcessor timeProvider: aTimeProvider ! !

!classDefinition: #ShopConfiguration category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:57:26'!
Object subclass: #ShopConfiguration
	instanceVariableNames: 'userAuthenticator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

!classDefinition: #ShopConfiguration category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:57:26'!
Object subclass: #ShopConfiguration
	instanceVariableNames: 'userAuthenticator priceList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

!classDefinition: #ShopConfiguration category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:57:26'!
Object subclass: #ShopConfiguration
	instanceVariableNames: 'userAuthenticator priceList merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

!classDefinition: #ShopConfiguration category: 'Tus-Libros' stamp: 'AW 6/27/2021 22:57:26'!
Object subclass: #ShopConfiguration
	instanceVariableNames: 'userAuthenticator priceList merchantProcessor timeProvider'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!
!ShopConfiguration methodsFor: 'initialization' stamp: 'AW 6/27/2021 22:57:26'!
initializeWithUserAuthenticator: aUserAuthenticator prices: aPriceList merchantProcessor: aMerchantProcessor timeProvider: aTimeProvider 
	self shouldBeImplemented.
	userAuthenticator := aUserAuthenticator.
	priceList := aPriceList.
	merchantProcessor := aMerchantProcessor.
	timeProvider := aTimeProvider.! !
!ShopConfiguration methodsFor: 'initialization' stamp: 'AW 6/27/2021 22:57:37' prior: 50334198!
initializeWithUserAuthenticator: aUserAuthenticator prices: aPriceList merchantProcessor: aMerchantProcessor timeProvider: aTimeProvider 
	userAuthenticator := aUserAuthenticator.
	priceList := aPriceList.
	merchantProcessor := aMerchantProcessor.
	timeProvider := aTimeProvider.! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:58:42'!
on: aPort shopConfiguration: aShopConfiguration 

	^self new initializeOn: aPort! !

!methodRemoval: TusLibrosRestInterface class #on: stamp: 'AW 6/27/2021 22:58:42'!
on: aPort

	^self new initializeOn: aPort!
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:59:04' prior: 50334223!
on: aPort shopConfiguration: aShopConfiguration 

	^self new initializeOn: aPort! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:59:35'!
initializeOn: aPort shopConfiguration: aShopConfiguration 

	port := aPort.
	
	webServer := WebServer new listenOn: self port.
	
	self configRoutes.! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 22:59:35' prior: 50334234!
on: aPort shopConfiguration: aShopConfiguration 

	^self new initializeOn: aPort shopConfiguration: aShopConfiguration! !

!methodRemoval: TusLibrosRestInterface #initializeOn: stamp: 'AW 6/27/2021 22:59:35'!
initializeOn: aPort

	port := aPort.
	
	webServer := WebServer new listenOn: self port.
	
	self configRoutes.!

!classDefinition: #TusLibrosRestInterface category: 'Tus-Libros' stamp: 'AW 6/27/2021 23:01:52'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'webServer port shop'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:01:50' prior: 50334240!
initializeOn: aPort shopConfiguration: aShopConfiguration 

	shop := self createShopFrom: aShopConfiguration.
	port := aPort.
	webServer := WebServer new listenOn: self port.
	
	self configRoutes.! !

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:02:22'!
createShopFrom: aShopConfiguration 
	self shouldBeImplemented.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:04:20' prior: 50334283!
createShopFrom: aShopConfiguration 
	^aShopConfiguration create.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:04:29' prior: 50334289!
createShopFrom: aShopConfiguration 
	^aShopConfiguration createShop.! !
!ShopConfiguration methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:04:40'!
createShop
	self shouldBeImplemented.! !
!ShopConfiguration methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:05:19' prior: 50334300!
createShop
	^Shop 
		withUserAuthenticator: userAuthenticator 
		prices: priceList 
		merchantProcessor: merchantProcessor 
		timeProvider: timeProvider.! !

tusLibrosWebServer startListening .!

tusLibrosWebServer destroy.!

WebUtils jsonEncode: 'Hola'!

WebUtils jsonEncode: 3 !

WebUtils jsonEncode: Dictionary new!

dict _ Dictionary new.!

dict at: 'id' put: 'tumama'!

WebUtils jsonEncode: dict.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:20:18' prior: 50334025!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		response _ Dictionary new.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		response at: 'cartId' put: cartId.
		request send200Response: WebUtils jsonEncode: response.
		
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:20:46' prior: 50334321!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		response _ Dictionary new.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:22:05' prior: 50334335!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		response _ Dictionary new.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:22:20' prior: 50334349!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		
		response _ Dictionary new.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:25:17' prior: 50334366!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		
		response _ Dictionary new.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | 
		cartItems _ shop listCart: cartId.
		
		response _ Dictionary new.
		response at: 'items' put: cartItems.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:25:48' prior: 50334383!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		
		response _ Dictionary new.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | 
		cartId _ request fields at: 'cartId'.
		cartItems _ shop listCart: cartId.
		
		response _ Dictionary new.
		response at: 'items' put: cartItems.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. !

tusLibrosWebServer startListening .!

onfiguration 
		withUserAuthenticator: (stubs mockUserAuthenticatorAlwaysReturning: true)
		prices: stubs priceList
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor
		timeProvider: stubs timeProvider. !


shopConfiguration _ ShopConfiguration 
		withUserAuthenticator: (stubs mockUserAuthenticatorAlwaysReturning: true)
		prices: stubs priceList
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor
		timeProvider: stubs timeProvider. !

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. !

tusLibrosWebServer startListening.!

tusLibrosWebServer destroy !


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
!

tusLibrosWebServer startListening.
!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!

tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!

tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!

tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!

TusLibrosRestInterface allInstances destroy .!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].!

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. !

tusLibrosWebServer startListening.!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:37:15' prior: 50334408!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		
		response _ Dictionary new.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | 
		cartId _ request fields at: 'cartId' asNumber .
		cartItems _ shop listCart: cartId.
		
		response _ Dictionary new.
		response at: 'items' put: cartItems.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !


tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 

tusLibrosWebServer startListening.
!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/27/2021 23:37:37' prior: 50334483!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		
		response _ Dictionary new.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | 
		cartId _ (request fields at: 'cartId') asNumber .
		cartItems _ shop listCart: cartId.
		
		response _ Dictionary new.
		response at: 'items' put: cartItems.
		request send200Response: (WebUtils jsonEncode: response).
		
	].! !


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 

tusLibrosWebServer startListening.!

tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 

tusLibrosWebServer startListening.!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!


tusLibrosWebServer stopListening.
tusLibrosWebServer destroy.!


TusLibrosRestInterface allInstances do: [ :x | x destroy ].!

servers _ OrderedCollection new.!
!ShopTest methodsFor: 'cart creation and listing' stamp: 'AW 6/27/2021 23:56:19' prior: 50332084!
test03ListCartWithOneItem
	
	| shop cartId cartItems bookIsbn quantity |
	
	shop := Shop 
		withUserAuthenticator: (MockUserAuthenticator alwaysReturning: true) 
		prices: stubs priceList 
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor 
		timeProvider: stubs timeProvider.
	
	cartId := shop createCartClientId: 3 password: '1234'.
	
	quantity := 2.
	bookIsbn := 'book_isbn'.
		
	shop add: quantity of: bookIsbn to: cartId.
	
	cartItems := shop listCart: cartId.
	
	self assert: cartItems size equals: 1.
	self assert: (cartItems first at: 'quantity') equals: quantity.
	self assert: (cartItems first at: 'item') equals: bookIsbn.! !
!ShopTest methodsFor: 'cart creation and listing' stamp: 'AW 6/27/2021 23:56:50' prior: 50334562!
test03ListCartWithOneItem
	
	| shop cartId cartItems bookIsbn quantity |
	
	shop := Shop 
		withUserAuthenticator: (MockUserAuthenticator alwaysReturning: true) 
		prices: stubs priceList 
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor 
		timeProvider: stubs timeProvider.
	
	cartId := shop createCartClientId: 3 password: '1234'.
	
	quantity := 2.
	bookIsbn := 'book_isbn'.
		
	shop add: quantity of: bookIsbn to: cartId.
	
	cartItems := shop listCart: cartId.
	
	self assert: cartItems size equals: 1.
	self assert: (cartItems first at: 'quantity') equals: quantity.
	self assert: (cartItems first at: 'item') equals: bookIsbn.! !

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/27/2021 23:57:11'!
ERROR!
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:02:16' prior: 50333132!
getCartEntries: aShoppingCartId

	^ (self getCart: aShoppingCartId) entries collect: [ :cartEntry | | ccc | 
		ccc _ Dictionary new.
		ccc at: 'item'	 put: cartEntry item.
		ccc at: 'quantity'	 put: cartEntry quantity.
	].! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:03:09' prior: 50334612!
getCartEntries: aShoppingCartId

	^ self getEntriesAsDictionary: (self getCart: aShoppingCartId) entries.! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:04:45'!
getEntriesAsDictionary: aEntryList

	^ aEntryList collect: [ :cartEntry | | entryDictionary | 
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: cartEntry item.
		entryDictionary at: 'quantity'	 put: cartEntry quantity.
	].! !

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 00:04:58'!
ERROR!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 00:04:58'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 00:04:58'!
ERROR!

self!

self at: 0!

self at: 1!
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:07:30' prior: 50334628!
getEntriesAsDictionary: aEntryList

	^ aEntryList collect: [ :cartEntry | | entryDictionary | 
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: cartEntry item.
		entryDictionary at: 'quantity'	 put: cartEntry quantity.
		entryDictionary.
	].! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:07:37' prior: 50334693!
getEntriesAsDictionary: aEntryList

	^ aEntryList collect: [ :cartEntry | | entryDictionary | 
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: cartEntry item.
		entryDictionary at: 'quantity'	 put: cartEntry quantity.
		entryDictionary
	].! !

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 00:08:04'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 00:08:09'!
PASSED!

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 00:09:47'!
PASSED!


tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 

tusLibrosWebServer startListening.!

WebUtils jsonEncode: OrderedCollection new!

OrderedCollection new asArray !

WebUtils jsonEncode: OrderedCollection new asArray !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:13:42' prior: 50334704!
getEntriesAsDictionary: aEntryList

	^ aEntryList collect: [ :cartEntry | | entryDictionary | 
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: cartEntry item.
		entryDictionary at: 'quantity'	 put: cartEntry quantity.
		entryDictionary
	] asArray.! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 00:13:56' prior: 50334897!
getEntriesAsDictionary: aEntryList

	^ (aEntryList collect: [ :cartEntry | | entryDictionary | 
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: cartEntry item.
		entryDictionary at: 'quantity'	 put: cartEntry quantity.
		entryDictionary
	]) asArray.! !

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 00:14:11'!
PASSED!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.
!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.
!

----QUIT----(28 June 2021 00:16:53) CuisUniversity-4532.image priorSource: 73944!

----STARTUP---- (28 June 2021 19:04:22) as /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!

!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:10:29' prior: 50334514!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | 
		clientId _ request fields at: 'clientId'.
		clientPassword _ request fields at: 'password'.
		cartId _ shop createCartClientId: clientId password: clientPassword.
		
		response _ Dictionary new.
		response at: 'cartId' put: cartId.
		request send200Response: (WebUtils jsonEncode: response).
		
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | 
		cartId _ (request fields at: 'cartId') asNumber .
		bookIsbn _ request fields at: 'boookIsbn'.
		bookQuantity _ (request fields at: 'bookQuantity') asNumber.
		
		shop add: bookQuantity of: bookIsbn to: cartId.
		
		response _ Dictionary new.
		response at: 'response' put: 'OK'.
		request send200Response: (WebUtils jsonEncode: response).
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | 
		cartId _ (request fields at: 'cartId') asNumber .
		cartItems _ shop listCart: cartId.
		
		response _ Dictionary new.
		response at: 'items' put: cartItems.
		request send200Response: (WebUtils jsonEncode: response).
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:14:08' prior: 50335060!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'boookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:17:56' prior: 50335100!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			self inspect.
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'boookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:18:57' prior: 50335155!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			self halt.
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'boookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

self fields!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:20:36' prior: 50335210!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			self halt.
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:23:15' prior: 50335266!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:42:48' prior: 50335321!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			self halt.
			cced _ FixedGregorianDate fromDate: (request fields at: 'cced')  .
			cco _ request fields at: 'cco'.
			
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].
! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

(request fields at: 'cced')!

FixedGregorianDate fromDate: (request fields at: 'cced')!

FixedGregorianDate fromDate: '10/15/2025' !

FixedGregorianDate fromDate: '2025/12/12' !

FixedGregorianDate monthOfYear: '12/2022' dayNumber: 10!

(GregorianMonthOfYear year: 2022 month: 12)!

(GregorianMonthOfYear year: 2022 month: 12)!

(GregorianMonthOfYear year: 2022 month: 12)!

(GregorianMonthOfYear year: 2022 month: 12)!

(GregorianMonthOfYear year: 2022 monthNumber: 12)!

(GregorianMonthOfYear yearNumber: 2022 monthNumber: 12)!

'10/2024' findTokens: '/'!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 19:59:59' prior: 50335376!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			self halt.
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) 
				monthNumber: (ccedSplitted at: 1). 
			
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].
! !

----QUIT----(28 June 2021 20:03:53) CuisUniversity-4532.image priorSource: 108829!

----STARTUP---- (28 June 2021 20:04:17) as /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!

!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:06:24' prior: 50335469!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) 
				monthNumber: (ccedSplitted at: 1). 
			
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:07:31' prior: 50335550!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) 
				monthNumber: (ccedSplitted at: 1). 
			self halt.
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:08:25' prior: 50335629!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			self halt.
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) 
				monthNumber: (ccedSplitted at: 1). 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:10:11' prior: 50335708!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			self halt.
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:14:48' prior: 50335793!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:24:02' prior: 50335884!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			self halt.
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

anError messageText!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:27:56' prior: 50335963!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!


TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 20:29:51' prior: 50336049!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | clientId password purchases response | [
			clientId _ (request fields at: 'clientId') asNumber.
			password _ request fields at: 'password'.
			
			purchases _ shop listPurchasesOf: clientId with: password.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 20:40:07' prior: 50333096!
listPurchasesOf: aClientId with: aClientPassword
	| dictionary purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	
	dictionary _ Dictionary new.
	
	
	! !
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 20:40:48' prior: 50336246!
listPurchasesOf: aClientId with: aClientPassword
	| dictionary purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: purchases total.! !
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 20:41:25' prior: 50336257!
listPurchasesOf: aClientId with: aClientPassword
	| dictionary purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: purchases total.
	dictionary at: 'items' put: purchases items asArray.! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 21:15:45' prior: 50334909!
getEntriesAsDictionary: aEntryBag

	^(aEntryBag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (aEntryBag ocurrencesOf: item).
		entryDictionary
	]) asArray.! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 21:16:01' prior: 50336283!
getEntriesAsDictionary: aEntryBag

	^(aEntryBag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (aEntryBag occurrencesOf: item).
		entryDictionary
	]) asArray.! !
!ShoppingCart methodsFor: 'adding' stamp: 'AW 6/28/2021 21:17:44' prior: 50333257!
add: aQuantity of: anItem 

	self assertQuantityIsValid: aQuantity.
	
	entries add: anItem withQuantity: aQuantity.! !
!ShoppingCart methodsFor: 'initialization' stamp: 'AW 6/28/2021 21:18:02' prior: 50333275 overrides: 16896425!
initialize

	entries := Bag new.! !
!ShoppingCart methodsFor: 'adding' stamp: 'AW 6/28/2021 21:18:29' prior: 50336307!
add: aQuantity of: anItem 

	self assertQuantityIsValid: aQuantity.
	
	entries add: anItem withOccurrences: aQuantity.! !

!classRemoval: #ShoppingCartEntry stamp: 'AW 6/28/2021 21:18:55'!
Object subclass: #ShoppingCartEntry
	instanceVariableNames: 'item quantity'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 21:19:14'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 21:19:14'!
ERROR!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 21:19:14'!
FAILURE!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 21:19:14'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 21:19:14'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 21:19:14'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 21:19:19'!
ERROR!
!ShoppingCartTest methodsFor: 'assertions' stamp: 'AW 6/28/2021 21:26:52' prior: 50332479!
assert: shoppingCart has: quantity of: item

	self assert: (shoppingCart entries occurrencesOf: item) equals: quantity ! !

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 21:27:02'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 21:27:04'!
FAILURE!
!ShoppingCartTest methodsFor: 'adding items' stamp: 'AW 6/28/2021 21:28:10' prior: 50332505!
test03AddingMultipleItemsToACart
	| shoppingCart |

	shoppingCart := ShoppingCart new.
	
	shoppingCart add: 1 of: book1.
	shoppingCart add: 2 of: book2.
	
	self assert: shoppingCart entries size equals: 3.
	self assert: shoppingCart has: 1 of: book1.
	self assert: shoppingCart has: 2 of: book2.! !

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 21:28:12'!
PASSED!

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 21:28:24'!
ERROR!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 21:28:24'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:28:28'!
ERROR!
!Cashier methodsFor: 'validation' stamp: 'AW 6/28/2021 21:29:10' prior: 50332588!
areAllItemsInPriceList: aBagOfShoppingCartEntries

	^ aBagOfShoppingCartEntries allSatisfy: [ :entry | priceList hasPriceFor: entry item ]! !
!Cashier methodsFor: 'validation' stamp: 'AW 6/28/2021 21:29:22' prior: 50336506!
areAllItemsInPriceList: aBagOfItems

	^ aBagOfItems allSatisfy: [ :entry | priceList hasPriceFor: entry item ]! !
!Cashier methodsFor: 'validation' stamp: 'AW 6/28/2021 21:29:46' prior: 50336513!
areAllItemsInPriceList: aBagOfItems

	^ aBagOfItems asSet allSatisfy: [ :item | priceList hasPriceFor: item ]! !

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:29:47'!
ERROR!
!Cashier methodsFor: 'private' stamp: 'AW 6/28/2021 21:31:29' prior: 50332569!
priceFor: anItem
	
	^(priceList priceFor: anItem item) * (anItem quantity).! !
!Cashier methodsFor: 'private' stamp: 'AW 6/28/2021 21:31:48' prior: 50336529!
priceFor: anItem
	
	^priceList priceFor: anItem.! !
!Cashier methodsFor: 'private' stamp: 'AW 6/28/2021 21:32:34' prior: 50332544!
calculateShoppingCartTotal: aShoppingCart

	^ aShoppingCart entries sum: [ :item |
		self priceFor: item.
	] ifEmpty: [
		self error: self class cantCheckoutEmptyCartErrorDescription .
	]! !

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:32:38'!
ERROR!
!Cashier methodsFor: 'private' stamp: 'AW 6/28/2021 21:33:27' prior: 50332552!
createReceiptWithTotal: anAmountOfMoney cart: aShoppingCart 

	| receipt |
	
	receipt _ Receipt withTotal: anAmountOfMoney items: aShoppingCart entries.
	receiptBook add: receipt.
	
	^receipt .! !

aShoppingCart entries!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:33:35'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 21:33:36'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 21:33:37'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 21:33:37'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 21:33:37'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 21:33:38'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 21:33:38'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 21:33:38'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 21:33:38'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:33:39'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:33:39'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:33:40'!
ERROR!
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 21:34:59' prior: 50336269!
listPurchasesOf: aClientId with: aClientPassword
	| dictionary purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: purchases total.
	dictionary at: 'items' put: purchases items asArray.
	^dictionary ! !

purchases items!

self asSet!
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 21:38:51'!
getBagAsDictionaryArray: aEntryBag

	^(aEntryBag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (aEntryBag occurrencesOf: item).
		entryDictionary
	]) asArray.! !
!Shop methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:38:51' prior: 50334622!
getCartEntries: aShoppingCartId

	^ self getBagAsDictionaryArray: (self getCart: aShoppingCartId) entries.! !

!methodRemoval: Shop #getEntriesAsDictionary: stamp: 'AW 6/28/2021 21:38:51'!
getEntriesAsDictionary: aEntryBag

	^(aEntryBag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (aEntryBag occurrencesOf: item).
		entryDictionary
	]) asArray.!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:39:04'!
ERROR!
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 21:39:45' prior: 50336603!
listPurchasesOf: aClientId with: aClientPassword
	| dictionary purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: purchases total.
	dictionary at: 'items' put: (self getBagAsDictionaryArray: purchases items).
	^dictionary ! !

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:39:48'!
ERROR!
!ShopTest methodsFor: 'check out and purchase listing' stamp: 'AW 6/28/2021 21:40:32' prior: 50332247!
test08ListPurchasesOnOnlyOneBuyClient
	
	| shop cartId clientId password purchases |
	
	shop := Shop withUserAuthenticator: (MockUserAuthenticator alwaysReturning: true) prices: stubs priceList merchantProcessor: stubs mockAlwaysOkMerchantProcessor timeProvider: stubs timeProvider.
		
	clientId := 15.
	password := '123456'.
	cartId := shop createCartClientId: clientId password: password.
	
	shop add: 2 of: stubs book1 to: cartId.
	
	shop checkOut: cartId payingWith: stubs validCreditCard.
	
	purchases := shop listPurchasesOf: clientId with: password.
	self assert: (purchases at: 'total') equals: 100.
	self assert: (purchases at: 'items') size equals: 2.
	self assert: (purchases items occurrencesOf: stubs book1) equals: 2.
	! !

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:40:37'!
FAILURE!
!ShopTest methodsFor: 'check out and purchase listing' stamp: 'AW 6/28/2021 21:43:11' prior: 50336669!
test08ListPurchasesOnOnlyOneBuyClient
	
	| shop cartId clientId password purchases |
	
	shop := Shop withUserAuthenticator: (MockUserAuthenticator alwaysReturning: true) prices: stubs priceList merchantProcessor: stubs mockAlwaysOkMerchantProcessor timeProvider: stubs timeProvider.
		
	clientId := 15.
	password := '123456'.
	cartId := shop createCartClientId: clientId password: password.
	
	shop add: 2 of: stubs book1 to: cartId.
	
	shop checkOut: cartId payingWith: stubs validCreditCard.
	
	purchases := shop listPurchasesOf: clientId with: password.
	self assert: (purchases total) equals: 100.
	self assert: (purchases items) size equals: 2.
	self assert: (purchases items occurrencesOf: stubs book1) equals: 2.
	! !
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 21:44:01' prior: 50336650!
listPurchasesOf: aClientId with: aClientPassword
	| dictionary purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: purchases total.
	dictionary at: 'items' put: (self getBagAsDictionaryArray: purchases items).
	^purchases ! !

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:44:03'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 21:44:04'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 21:44:05'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 21:44:05'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 21:44:06'!
PASSED!

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 21:44:13'!
PASSED!
!Shop methodsFor: 'facade' stamp: 'AW 6/28/2021 21:44:36' prior: 50336724!
listPurchasesOf: aClientId with: aClientPassword
	| purchases |
	self
		authenticateClient: aClientId
		withPassword: aClientPassword.
	purchases _ PurchasesSummary for: (self receiptsFor: aClientId).
	
	^purchases ! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:46:35'!
serializePurchases: aPurchasesSummary
	| dictionary |
	
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: aPurchasesSummary total.
	dictionary at: 'items' put: (self getBagAsDictionaryArray: aPurchasesSummary items).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:46:42' prior: 50336884!
serializePurchases: aPurchasesSummary
	| dictionary |
	
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: aPurchasesSummary total.
	dictionary at: 'items' put: (self getBagAsDictionaryArray: aPurchasesSummary items).
	
	^dictionary .! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:47:40' prior: 50336158!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | clientId password purchases response | [
			clientId _ (request fields at: 'clientId') asNumber.
			password _ request fields at: 'password'.
			
			purchases _ shop listPurchasesOf: clientId with: password.
			
			response _ Dictionary new.
			response at: 'purchases' put: (self serializePurchases: purchases).
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 21:47:48'!
PASSED!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:48:12' prior: 50336907!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | clientId password purchases response | [
			self halt.
			clientId _ (request fields at: 'clientId') asNumber.
			password _ request fields at: 'password'.
			
			purchases _ shop listPurchasesOf: clientId with: password.
			
			response _ Dictionary new.
			response at: 'purchases' put: (self serializePurchases: purchases).
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:50:18' prior: 50337116!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | | clientId password purchases response | [
			self halt.
			clientId _ (request fields at: 'clientId') asNumber.
			password _ request fields at: 'password'.
			
			purchases _ shop listPurchasesOf: clientId with: password.
			
			response _ Dictionary new.
			response at: 'purchases' put: (self serializePurchases: purchases).
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:55:38'!
handleListPurchasesRequest: request
	| clientId password purchases response |
	self halt.
	clientId _ (request fields at: 'clientId') asNumber.
	password _ request fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	request send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:55:50' prior: 50337302!
handleListPurchasesRequest: aRequest
	| clientId password purchases response |
	self halt.
	clientId _ (aRequest fields at: 'clientId') asNumber.
	password _ aRequest fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:55:55' prior: 50337319!
handleListPurchasesRequest: aRequest
	| clientId password purchases response |
	
	self halt.
	clientId _ (aRequest fields at: 'clientId') asNumber.
	password _ aRequest fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:56:25' prior: 50337212!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | [
			self handleListPurchasesRequest: request
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 21:57:50' prior: 50337353!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | [
			self handleListPurchasesRequest: request
		] onErrorDo: [ :anError |
			request send400Response: (anError messageText) 
		]
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:00:19' prior: 50337432!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request 
	] onErrorDo: [ :request :anError |
		request send400Response: (anError messageText) 
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:00:37'!
addService: aString action: aBlockClosure onErrorDo: aBlockClosure3 
	self shouldBeImplemented.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:01:06' prior: 50337608!
addService: aRootString action: aBlockClosure onErrorDo: aErrorBlockClosure 
	self shouldBeImplemented.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:02:47' prior: 50337615!
addService: aRouteString action: aBlockClosure onErrorDo: aErrorBlockClosure 
	
	webServer addService: aRouteString action: [ :aRequest |
		(aBlockClosure value: aRequest) on: Error do: aErrorBlockClosure.
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:04:34' prior: 50337622!
addService: aRouteString action: aBlockClosure onErrorDo: aErrorBlockClosure 
	
	webServer addService: aRouteString action: [ :aRequest |
		(aBlockClosure value: aRequest) on: Error do: [ :anError |
			aErrorBlockClosure value: anError
		].
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:09:08' prior: 50337632!
addService: aRouteString action: aBlockClosure onErrorDo: aErrorBlockClosure 
	
	webServer addService: aRouteString action: [ :aRequest |
		[ aBlockClosure value: aRequest ] on: Error do: [ :anError |
			aErrorBlockClosure value: anError
		].
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:12:42' prior: 50337644!
addService: aRouteString action: aBlockClosure onErrorDo: aErrorBlockClosure 
	
	webServer addService: aRouteString action: ([ :aRequest |
		aBlockClosure value: aRequest 
	] on: Error do: [ :anError |
		aErrorBlockClosure value: anError
	]).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:13:44' prior: 50334032!
addService: aRouteString action: aBlockClosure

	self addService: aRouteString 
		action: aBlockClosure 
		onErrorDo: [ :anError |
		
	].
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:15:01' prior: 50337656!
addService: aRouteString action: aBlockClosure onErrorDo: aErrorBlockClosure 
	
	webServer addService: aRouteString action: [ :aRequest |
		[ aBlockClosure value: aRequest ] on: Error do: [ :anError |
			aErrorBlockClosure value: aRequest value: anError.	
		] 
	].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:16:29' prior: 50337667!
addService: aRouteString action: aBlockClosure

	self addService: aRouteString 
		action: aBlockClosure 
		onErrorDo: [ :aRequest :anError |
		
	].
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:16:45' prior: 50337687!
addService: aRouteString action: aBlockClosure

	self addService: aRouteString 
		action: aBlockClosure 
		onErrorDo: [ :aRequest :anError |
		aRequest send400Response: (anError messageText)
	].
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:16:57' prior: 50337523!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request 
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 22:20:07' prior: 50337706!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ request fields at: 'clientId'.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

clientReceipts at: aClientId!

		self at: '10'!

(self findElementOrNil: arg1)!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:30:07' prior: 50337783!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ (request fields at: 'clientId') asNumber.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: cartItems.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

(self serializePurchases: purchases)!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:38:59' prior: 50337336!
handleListPurchasesRequest: aRequest
	| clientId password purchases response |
	
	clientId _ (aRequest fields at: 'clientId') asNumber.
	password _ aRequest fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!FormSection methodsFor: 'initialization' stamp: 'AW 6/28/2021 23:42:52' prior: 50814657!
initializeWithTitle: arg1 withExplanation: arg2 withColor: arg3
	| temp4 |
	title _ arg1.
	explanation _ arg2.
	self separation: 3.
	self color: arg3.
	titleMorph _ LabelMorph 
		contents: title
		font: Preferences windowTitleFont
		emphasis: 1.
	temp4 _ LayoutSpec
		fixedWidth: titleMorph morphWidth
		fixedHeight: titleMorph morphHeight.
	temp4 offAxisEdgeWeight: 0.03.
	self
		addMorph: titleMorph
		layoutSpec: temp4.
	explanation isEmpty ifFalse: [
		explanationMorph _ ImmutableTextModelMorph
			withText: arg2
			withColor: arg3
			withWidth: self fixedWidthForTexts.
		self addMorph: explanationMorph ].! !
!LabeledInput methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:43:05' prior: 50814774!
withLabel: arg1 withWidth: arg2 withModel: arg3 usingAs: arg4
	| temp5 temp6 |
	self separation: 5.
	self layoutSpec:
		(LayoutSpec
			proportionalWidth: 0.95
			fixedHeight: LabeledInput recommendedHeight).
	labelMorph _ LabelMorph contents: arg1.
	temp5 _ LayoutSpec
		fixedWidth: arg2
		fixedHeight: labelMorph morphHeight
		offAxisEdgeWeight: #center.
	self
		addMorph: labelMorph
		layoutSpec: temp5.
	inputMorph _ TabPassingTextModelMorph withModel: arg3.
	inputMorph textMorph focusMover: arg4.
	arg4 addFocusReceiver: inputMorph textMorph.
	inputMorph hideScrollBarsIndefinitely.
	temp6 _ LayoutSpec
		fixedWidth: LabeledInput inputWidth * 0.7
		fixedHeight: labelMorph morphHeight + 2.
	self
		addMorph: inputMorph
		layoutSpec: temp6.! !
!MessageKeywordsAndParametersTable methodsFor: 'GUI building' stamp: 'AW 6/28/2021 23:43:22' prior: 50815089!
buildColumnTitlesRowFor: arg1
	| temp2 temp3 |
	temp3 _ LayoutMorph newRow.
	temp3 color: self backgroundColor.
	temp3 separation: self columnSeparation.
	temp2 _ OrderedCollection newFrom: arg1.
	temp2 addFirst: ''.
	self needsToReorderRows ifTrue: [ temp2 addLast: 'Change order' ].
	temp2 withIndexDo: [ :arg4 :arg5 | | temp6 temp7 |
		temp7 _ LayoutMorph newRow.
		temp7 color: self backgroundColor.
		temp7 axisEdgeWeight: #center.
		temp7 addMorph: (LabelMorph contents: arg4).
		temp6 _ LayoutSpec fixedWidth: (columnWidths at: arg5).
		temp3
			addMorph: temp7
			layoutSpec: temp6 ].
	^ temp3.! !
!MessageKeywordsAndParametersTable methodsFor: 'initialization' stamp: 'AW 6/28/2021 23:43:31' prior: 50814979!
withRows: arg1 withColor: arg2 withPreviewModel: arg3 withRefactoringModel: arg4
	| temp5 temp6 temp7 temp8 temp9 temp10 temp11 |
	backgroundColor _ arg2.
	rowModels _ OrderedCollection new.
	previewModel _ arg3.
	refactoringModel _ arg4.
	variablesToParametrize _ arg1.
	temp5 _ 4.
	self separation: temp5.
	temp7 _ arg1 size + 1.
	temp6 _ self rowHeight * temp7 + (temp5 * (temp7 + 1)) * 1.1.
	temp10 _ #('Keyword' 'Parameter name' ).
	columnWidths _ self
		columnWidthsRequiredForRowTitles: arg1
		forInputColumns: temp10 size.
	temp9 _ columnWidths sum + (self columnSeparation * (columnWidths size + 1)) * 1.1.
	self layoutSpec:
		(LayoutSpec
			fixedWidth: temp9
			fixedHeight: temp6).
	temp8 _ self buildColumnTitlesRowFor: temp10.
	self
		addMorph: temp8
		layoutSpec: self rowsLayoutSpec.
	arg1 withIndexDo: [ :arg13 :arg14 | | temp15 temp16 temp17 temp18 temp19 |
		temp15 _ LayoutMorph newRow.
		temp15
			color: self backgroundColor;
			separation: self columnSeparation.
		temp15
			addMorph: (LabelMorph contents: arg13)
			layoutSpec: (LayoutSpec fixedWidth: (columnWidths at: 1)).
		temp18 _ LayoutSpec
			fixedWidth: (columnWidths at: 2)
			fixedHeight: self rowHeight.
		temp17 _ self buildInputMorphWith: (arg4 keywordModelOf: arg13).
		temp15
			addMorph: temp17
			layoutSpec: temp18.
		temp19 _ self buildInputMorphWith: (arg4 parameterModelOf: arg13).
		temp15
			addMorph: temp19
			layoutSpec: temp18.
		self needsToReorderRows ifTrue: [
			temp16 _ ChangeRowOrderButtonModel
				for: arg1 size - (arg14 - 1)
				notifying: self.
			rowModels addFirst: temp16.
			temp11 _ self buildChangeOrderButtonsWith: temp16.
			temp15
				addMorph: temp11
				layoutSpec: (LayoutSpec fixedWidth: columnWidths last) ].
		self
			addMorph: temp15
			layoutSpec: self rowsLayoutSpec ].! !

!classDefinition: #BagSerializer category: 'Tus-Libros' stamp: 'AW 6/28/2021 23:48:18'!
Object subclass: #BagSerializer
	instanceVariableNames: 'bag'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros'!
!BagSerializer class methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:48:18'!
getBagAsDictionaryArray: aBag
	^self new initializeGetBagAsDictionaryArray: aBag! !
!BagSerializer methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:48:18'!
initializeGetBagAsDictionaryArray: aBag
	bag := aBag.! !
!BagSerializer methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:48:18'!
getBagAsDictionaryArray

	^(bag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (bag occurrencesOf: item).
		entryDictionary
	]) asArray.! !
!Shop methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:48:18' prior: 50336618!
getBagAsDictionaryArray: aEntryBag
	^(BagSerializer getBagAsDictionaryArray: aEntryBag) getBagAsDictionaryArray! !
!BagSerializer methodsFor: 'initialization' stamp: 'AW 6/28/2021 23:49:09'!
initializeWith: aBag
	bag := aBag.! !
!BagSerializer class methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:49:09' prior: 50338113!
getBagAsDictionaryArray: aBag
	^self new initializeWith: aBag! !

!methodRemoval: BagSerializer #initializeGetBagAsDictionaryArray: stamp: 'AW 6/28/2021 23:49:09'!
initializeGetBagAsDictionaryArray: aBag
	bag := aBag.!
!BagSerializer class methodsFor: 'instance creation' stamp: 'AW 6/28/2021 23:50:54' prior: 50338146!
getBagAsDictionaryArray: aBag
	^(self new initializeWith: aBag) getBagAsDictionaryArray ! !
!BagSerializer class methodsFor: 'instance creation' stamp: 'AW 6/28/2021 23:51:17' prior: 50338156!
getBagAsDictionaryArray: aBag
	^self new initializeWith: aBag ! !
!BagSerializer class methodsFor: 'instance creation' stamp: 'AW 6/28/2021 23:51:19' prior: 50338163!
getBagAsDictionaryArray: aBag
	^self new initializeWith: aBag ! !
!BagSerializer class methodsFor: 'instance creation' stamp: 'AW 6/28/2021 23:51:57'!
bag: aBag
	^self new initializeWith: aBag ! !
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 23:51:57'!
bag: aEntryBag
	^(BagSerializer getBagAsDictionaryArray: aEntryBag) getBagAsDictionaryArray! !
!Shop methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:51:57' prior: 50336630!
getCartEntries: aShoppingCartId

	^ self bag: (self getCart: aShoppingCartId) entries.! !
!Shop methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:51:57' prior: 50338135!
getBagAsDictionaryArray: aEntryBag
	^(BagSerializer bag: aEntryBag) getBagAsDictionaryArray! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:51:57' prior: 50336895!
serializePurchases: aPurchasesSummary
	| dictionary |
	
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: aPurchasesSummary total.
	dictionary at: 'items' put: (self bag: aPurchasesSummary items).
	
	^dictionary .! !
!Shop methodsFor: 'as yet unclassified' stamp: 'AW 6/28/2021 23:51:57' prior: 50338178!
bag: aEntryBag
	^(BagSerializer bag: aEntryBag) getBagAsDictionaryArray! !

!methodRemoval: BagSerializer class #getBagAsDictionaryArray: stamp: 'AW 6/28/2021 23:51:57'!
getBagAsDictionaryArray: aBag
	^self new initializeWith: aBag !

!methodRemoval: Shop #getBagAsDictionaryArray: stamp: 'AW 6/28/2021 23:51:57'!
getBagAsDictionaryArray: aEntryBag
	^(BagSerializer bag: aEntryBag) getBagAsDictionaryArray!
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 23:54:13' prior: 50338184!
getCartEntries: aShoppingCartId

	| entriesBag |
	entriesBag _ (self getCart: aShoppingCartId) entries.
	^ (BagSerializer bag: entriesBag) getBagAsDictionaryArray .! !

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 23:54:25'!
PASSED!

!methodRemoval: Shop #bag: stamp: 'AW 6/28/2021 23:54:40'!
bag: aEntryBag
	^(BagSerializer bag: aEntryBag) getBagAsDictionaryArray!

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 23:54:43'!
PASSED!
!Shop methodsFor: 'cart persistence' stamp: 'AW 6/28/2021 23:56:15' prior: 50338223!
getCartEntries: aShoppingCartId

	^(self getCart: aShoppingCartId) entries.! !

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 23:56:54'!
FAILURE!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 23:56:54'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 23:56:54'!
FAILURE!
!ShopTest methodsFor: 'cart creation and listing' stamp: 'AW 6/28/2021 23:57:22' prior: 50334586!
test03ListCartWithOneItem
	
	| shop cartId cartItems bookIsbn quantity |
	
	shop := Shop 
		withUserAuthenticator: (MockUserAuthenticator alwaysReturning: true) 
		prices: stubs priceList 
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor 
		timeProvider: stubs timeProvider.
	
	cartId := shop createCartClientId: 3 password: '1234'.
	
	quantity := 2.
	bookIsbn := 'book_isbn'.
		
	shop add: quantity of: bookIsbn to: cartId.
	
	cartItems := shop listCart: cartId.
	
	self assert: cartItems size equals: 2.
	self assert: (cartItems first at: 'quantity') equals: quantity.
	self assert: (cartItems first at: 'item') equals: bookIsbn.! !

(cartItems occurrencesOf: bookIsbn)!
!ShopTest methodsFor: 'cart creation and listing' stamp: 'AW 6/28/2021 23:59:17' prior: 50338602!
test03ListCartWithOneItem
	
	| shop cartId cartItems bookIsbn quantity |
	
	shop := Shop 
		withUserAuthenticator: (MockUserAuthenticator alwaysReturning: true) 
		prices: stubs priceList 
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor 
		timeProvider: stubs timeProvider.
	
	cartId := shop createCartClientId: 3 password: '1234'.
	
	quantity := 2.
	bookIsbn := 'book_isbn'.
		
	shop add: quantity of: bookIsbn to: cartId.
	
	cartItems := shop listCart: cartId.
	
	self assert: cartItems size equals: 2.
	self assert: (cartItems occurrencesOf: bookIsbn) equals: quantity.! !

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 23:59:23'!
PASSED!

!testRun: #CheckOutTest #test01CheckoutEmptyCartShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test02CheckoutACartWithOneItem stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test03CheckoutACartWithMultipleItems stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test04CheckoutItemWithoutPricesShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test05CheckoutWithExpiredCardShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test06CheckoutWithCardExpiredThisMonthShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test07CheckoutWithStolenCardShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test08CheckoutWithFakeCardShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test09CheckoutWithInsufficientFundsShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test10CheckoutWithInvalidCardNumberShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test11CheckoutWithEmptyCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #CheckOutTest #test12CheckoutWithBlankCardOwnerNameShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #PriceListTest #test01AddItemWithNegativePriceShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #PriceListTest #test02AddItemWithZeroPriceShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test01InvalidClientShallNotPass stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test02NewCartsAreEmpty stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test03ListCartWithOneItem stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test04ListInvalidCartShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test05AddItemToCartDoesntModifyOtherCarts stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test06CheckoutInvalidCartIdShouldRaiseError stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test07CheckoutUsesTheCashier stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test08ListPurchasesOnOnlyOneBuyClient stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test09ListPurchasesOfManyItemsByOneClient stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test10CheckoutWithInvalidCreditCardShouldFail stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test11ListMultiplePurchasesOfTheSameClient stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test12ListPurchasesOfIncorrectPasswordShouldFail stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test13ListPurchasesOfDifferentClients stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test14CheckingOutAnExpiredCardShouldFail stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test15CheckingOutInADifferentPointInTimeShouldWorkAsIntended stamp: 'AW 6/28/2021 23:59:27'!
PASSED!

!testRun: #ShopTest #test16AddingItemsToAnExpiredCartShouldFail stamp: 'AW 6/28/2021 23:59:28'!
PASSED!

!testRun: #ShoppingCartTest #test01EmptyCartHasNoItems stamp: 'AW 6/28/2021 23:59:28'!
PASSED!

!testRun: #ShoppingCartTest #test02AddingAnItemToACart stamp: 'AW 6/28/2021 23:59:28'!
PASSED!

!testRun: #ShoppingCartTest #test03AddingMultipleItemsToACart stamp: 'AW 6/28/2021 23:59:28'!
PASSED!

!testRun: #ShoppingCartTest #test04AddingANegativeQuantityRaisesError stamp: 'AW 6/28/2021 23:59:28'!
PASSED!

!testRun: #ShoppingCartTest #test05AddingZeroQuantityRaisesError stamp: 'AW 6/28/2021 23:59:28'!
PASSED!

!testRun: #ShoppingCartTest #test06AddingNonIntegerQuantityRaisesError stamp: 'AW 6/28/2021 23:59:28'!
PASSED!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:04:08' prior: 50337868!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ (request fields at: 'clientId') asNumber.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: (BagSerializer bag: cartItems) getBagAsDictionaryArray .
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !
!BagSerializer methodsFor: 'evaluating' stamp: 'AW 6/29/2021 00:04:23'!
asDictionaryArray

	^(bag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (bag occurrencesOf: item).
		entryDictionary
	]) asArray.! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:04:23' prior: 50338771!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | | cartId clientId clientPassword response | [
			clientId _ (request fields at: 'clientId') asNumber.
			clientPassword _ request fields at: 'password'.
			cartId _ shop createCartClientId: clientId password: clientPassword.
			
			response _ Dictionary new.
			response at: 'cartId' put: cartId.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !

!methodRemoval: BagSerializer #getBagAsDictionaryArray stamp: 'AW 6/29/2021 00:04:23'!
getBagAsDictionaryArray

	^(bag asSet collect: [ :item | | entryDictionary |
		entryDictionary _ Dictionary new.
		entryDictionary at: 'item'	 put: item.
		entryDictionary at: 'quantity'	 put: (bag occurrencesOf: item).
		entryDictionary
	]) asArray.!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:06:29' prior: 50337958!
handleListPurchasesRequest: aRequest
	| clientId password purchases response |
	
	self halt.
	clientId _ (aRequest fields at: 'clientId') asNumber.
	password _ aRequest fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:07:26' prior: 50338197!
serializePurchases: aPurchasesSummary
	| dictionary |
	
	dictionary _ Dictionary new.
	
	dictionary at: 'total' put: aPurchasesSummary total.
	dictionary at: 'items' put: (BagSerializer bag: aPurchasesSummary items) asDictionaryArray.
	
	^dictionary .! !

aPurchasesSummary items!

(BagSerializer bag: aPurchasesSummary items) asDictionaryArray!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:08:39' prior: 50338955!
handleListPurchasesRequest: aRequest
	| clientId password purchases response |
	
	clientId _ (aRequest fields at: 'clientId') asNumber.
	password _ aRequest fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:10:46'!
handleCreateCartRequest: request
	| cartId clientId clientPassword response |
	clientId _ (request fields at: 'clientId') asNumber.
	clientPassword _ request fields at: 'password'.
	cartId _ shop createCartClientId: clientId password: clientPassword.
	
	response _ Dictionary new.
	response at: 'cartId' put: cartId.
	request send200Response: (WebUtils jsonEncode: response).
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:10:53' prior: 50339003!
handleCreateCartRequest: request
	| cartId clientId clientPassword response |
	
	clientId _ (request fields at: 'clientId') asNumber.
	clientPassword _ request fields at: 'password'.
	cartId _ shop createCartClientId: clientId password: clientPassword.
	
	response _ Dictionary new.
	response at: 'cartId' put: cartId.
	request send200Response: (WebUtils jsonEncode: response).
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:10:56' prior: 50339019!
handleCreateCartRequest: Arequest
	| cartId clientId clientPassword response |
	
	clientId _ (Arequest fields at: 'clientId') asNumber.
	clientPassword _ Arequest fields at: 'password'.
	cartId _ shop createCartClientId: clientId password: clientPassword.
	
	response _ Dictionary new.
	response at: 'cartId' put: cartId.
	Arequest send200Response: (WebUtils jsonEncode: response).
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:11:01' prior: 50339035!
handleCreateCartRequest: aRequest
	| cartId clientId clientPassword response |
	
	clientId _ (aRequest fields at: 'clientId') asNumber.
	clientPassword _ aRequest fields at: 'password'.
	cartId _ shop createCartClientId: clientId password: clientPassword.
	
	response _ Dictionary new.
	response at: 'cartId' put: cartId.
	aRequest send200Response: (WebUtils jsonEncode: response).
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:11:45'!
handleAddToCartRequest: request
	
	| bookIsbn bookQuantity cartId response |
	cartId _ (request fields at: 'cartId') asNumber .
	bookIsbn _ request fields at: 'bookIsbn'.
	bookQuantity _ (request fields at: 'bookQuantity') asNumber.
	
	shop add: bookQuantity of: bookIsbn to: cartId.
	
	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	request send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:11:53' prior: 50339066!
handleAddToCartRequest: request
	| bookIsbn bookQuantity cartId response |
	
	cartId _ (request fields at: 'cartId') asNumber .
	bookIsbn _ request fields at: 'bookIsbn'.
	bookQuantity _ (request fields at: 'bookQuantity') asNumber.
	
	shop add: bookQuantity of: bookIsbn to: cartId.
	
	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	request send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:11:56' prior: 50339083!
handleAddToCartRequest: aRequest
	| bookIsbn bookQuantity cartId response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	bookIsbn _ aRequest fields at: 'bookIsbn'.
	bookQuantity _ (aRequest fields at: 'bookQuantity') asNumber.
	
	shop add: bookQuantity of: bookIsbn to: cartId.
	
	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	aRequest send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:12:24'!
handleListCart: request
	| cartId cartItems response |
	cartId _ (request fields at: 'cartId') asNumber .
	cartItems _ shop listCart: cartId.
	
	response _ Dictionary new.
	response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
	request send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:12:29' prior: 50339116!
handleListCart: request
	| cartId cartItems response |
	
	cartId _ (request fields at: 'cartId') asNumber .
	cartItems _ shop listCart: cartId.
	
	response _ Dictionary new.
	response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
	request send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:12:34' prior: 50339130!
handleListCart: aRequest
	| cartId cartItems response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	cartItems _ shop listCart: cartId.
	
	response _ Dictionary new.
	response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
	aRequest send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:13:19'!
handleCheckOutCart: request
			| cartId cced ccedSplitted ccn cco creditCard response |
	cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:13:40' prior: 50339157!
handleCheckOutCart: request
	| cartId cced ccedSplitted ccn cco creditCard response |
	
	cartId _ (request fields at: 'cartId') asNumber .
	ccn _ request fields at: 'ccn' .
	ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
	cco _ request fields at: 'cco'.
	cced _ GregorianMonthOfYear 
		yearNumber: (ccedSplitted at: 2) asNumber
		monthNumber: (ccedSplitted at: 1) asNumber. 
	creditCard _ CreditCard number: ccn owner: cco expiration: cced.

	shop checkOut: cartId payingWith: creditCard.

	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	request send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:13:45' prior: 50339181!
handleCheckOutCart: aRequest
	| cartId cced ccedSplitted ccn cco creditCard response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	ccn _ aRequest fields at: 'ccn' .
	ccedSplitted _ (aRequest fields at: 'cced') findTokens: '/'.
	cco _ aRequest fields at: 'cco'.
	cced _ GregorianMonthOfYear 
		yearNumber: (ccedSplitted at: 2) asNumber
		monthNumber: (ccedSplitted at: 1) asNumber. 
	creditCard _ CreditCard number: ccn owner: cco expiration: cced.

	shop checkOut: cartId payingWith: creditCard.

	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:14:52' prior: 50338860!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | 
		self handleCreateCartRequest: request.
	].

	self addService: '/addToCart' action: [ :request | | cartId bookIsbn bookQuantity response | [
			cartId _ (request fields at: 'cartId') asNumber .
			bookIsbn _ request fields at: 'bookIsbn'.
			bookQuantity _ (request fields at: 'bookQuantity') asNumber.
			
			shop add: bookQuantity of: bookIsbn to: cartId.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:15:08' prior: 50339229!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | 
		self handleCreateCartRequest: request.
	].

	self addService: '/addToCart' action: [ :request | 
		self handleAddToCartRequest: request.
	].

	self addService: '/listCart' action: [ :request | | cartId response cartItems | [
			cartId _ (request fields at: 'cartId') asNumber .
			cartItems _ shop listCart: cartId.
			
			response _ Dictionary new.
			response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:15:27' prior: 50339295!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | 
		self handleCreateCartRequest: request.
	].

	self addService: '/addToCart' action: [ :request | 
		self handleAddToCartRequest: request.
	].

	self addService: '/listCart' action: [ :request |
		self handleListCart: request.
	].

	self addService: '/checkOutCart' action: [ :request | | cartId ccn cced ccedSplitted cco creditCard response | [
			cartId _ (request fields at: 'cartId') asNumber .
			ccn _ request fields at: 'ccn' .
			ccedSplitted _ (request fields at: 'cced') findTokens: '/'.
			cco _ request fields at: 'cco'.
			cced _ GregorianMonthOfYear 
				yearNumber: (ccedSplitted at: 2) asNumber
				monthNumber: (ccedSplitted at: 1) asNumber. 
			creditCard _ CreditCard number: ccn owner: cco expiration: cced.
			
			shop checkOut: cartId payingWith: creditCard.
			
			response _ Dictionary new.
			response at: 'response' put: 'OK'.
			request send200Response: (WebUtils jsonEncode: response).
		] on: Error do: [ :anError |
			request send400Response: (anError messageText) 
		]
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:15:49' prior: 50339347!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | 
		self handleCreateCartRequest: request.
	].

	self addService: '/addToCart' action: [ :request | 
		self handleAddToCartRequest: request.
	].

	self addService: '/listCart' action: [ :request |
		self handleListCart: request.
	].

	self addService: '/checkOutCart' action: [ :request | 
		self handleCheckOutCart: request.
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:16:12'!
handleListCartRequest: aRequest
	| cartId cartItems response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	cartItems _ shop listCart: cartId.
	
	response _ Dictionary new.
	response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
	aRequest send200Response: (WebUtils jsonEncode: response).! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:16:12' prior: 50339388!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | 
		self handleCreateCartRequest: request.
	].

	self addService: '/addToCart' action: [ :request | 
		self handleAddToCartRequest: request.
	].

	self addService: '/listCart' action: [ :request |
		self handleListCartRequest: request.
	].

	self addService: '/checkOutCart' action: [ :request | 
		self handleCheckOutCart: request.
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !

!methodRemoval: TusLibrosRestInterface #handleListCart: stamp: 'AW 6/29/2021 00:16:12'!
handleListCart: aRequest
	| cartId cartItems response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	cartItems _ shop listCart: cartId.
	
	response _ Dictionary new.
	response at: 'items' put: (BagSerializer bag: cartItems) asDictionaryArray .
	aRequest send200Response: (WebUtils jsonEncode: response).!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:16:22'!
handleCheckOutCartRequest: aRequest
	| cartId cced ccedSplitted ccn cco creditCard response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	ccn _ aRequest fields at: 'ccn' .
	ccedSplitted _ (aRequest fields at: 'cced') findTokens: '/'.
	cco _ aRequest fields at: 'cco'.
	cced _ GregorianMonthOfYear 
		yearNumber: (ccedSplitted at: 2) asNumber
		monthNumber: (ccedSplitted at: 1) asNumber. 
	creditCard _ CreditCard number: ccn owner: cco expiration: cced.

	shop checkOut: cartId payingWith: creditCard.

	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	aRequest send200Response: (WebUtils jsonEncode: response).


! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:16:22' prior: 50339421!
configRoutes
	
	
	self addService: '/createCart' action: [ :request | 
		self handleCreateCartRequest: request.
	].

	self addService: '/addToCart' action: [ :request | 
		self handleAddToCartRequest: request.
	].

	self addService: '/listCart' action: [ :request |
		self handleListCartRequest: request.
	].

	self addService: '/checkOutCart' action: [ :request | 
		self handleCheckOutCartRequest: request.
	].

	self addService: '/listPurchases' action: [ :request | 
		self handleListPurchasesRequest: request.
	].


! !

!methodRemoval: TusLibrosRestInterface #handleCheckOutCart: stamp: 'AW 6/29/2021 00:16:22'!
handleCheckOutCart: aRequest
	| cartId cced ccedSplitted ccn cco creditCard response |
	
	cartId _ (aRequest fields at: 'cartId') asNumber .
	ccn _ aRequest fields at: 'ccn' .
	ccedSplitted _ (aRequest fields at: 'cced') findTokens: '/'.
	cco _ aRequest fields at: 'cco'.
	cced _ GregorianMonthOfYear 
		yearNumber: (ccedSplitted at: 2) asNumber
		monthNumber: (ccedSplitted at: 1) asNumber. 
	creditCard _ CreditCard number: ccn owner: cco expiration: cced.

	shop checkOut: cartId payingWith: creditCard.

	response _ Dictionary new.
	response at: 'response' put: 'OK'.
	aRequest send200Response: (WebUtils jsonEncode: response).


!

TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AW 6/29/2021 00:17:58' prior: 50338987!
handleListPurchasesRequest: aRequest
	| clientId password purchases response |
	
	self halt.
	clientId _ (aRequest fields at: 'clientId') asNumber.
	password _ aRequest fields at: 'password'.
	
	purchases _ shop listPurchasesOf: clientId with: password.
	
	response _ Dictionary new.
	response at: 'purchases' put: (self serializePurchases: purchases).
	aRequest send200Response: (WebUtils jsonEncode: response).


! !

TusLibrosRestInterface allInstances do: [ :x | x destroy ].!

----QUIT----(29 June 2021 00:20:52) CuisUniversity-4532.image priorSource: 124493!

----STARTUP---- (1 July 2021 17:16:08) as /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!


----End fileIn of /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/2021-1c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 7/1/2021 17:56:58'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 7/1/2021 17:56:58'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of /opt/Cuis/Packages/Features/Color-Extras.pck.st----!

----End fileIn of /opt/Cuis/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 7/1/2021 17:57:52'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 7/1/2021 17:57:52'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/2021-1c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

----End fileIn of /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/2021-1c/20-TusLibros/Iteracion 4/WebClient.pck.st----!

Object subclass: #ShopWebClient
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!

!classDefinition: #ShopWebClient category: 'Tus-Libros-Web-Client' stamp: 'AW 7/1/2021 18:07:48'!
Object subclass: #ShopWebClient
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!ShopWebClient methodsFor: 'no messages' stamp: 'AW 7/1/2021 18:08:43' overrides: 16896425!
initialize

	! !

self superclass!

self super class!

self class!

self class!

self class superclass !

self class superclass superclass !

self class superclass superclass  superclass !

self class superclass superclass  superclass  superclass !

self class superclass superclass  superclass  superclass  WidgetMorph !

self class superclass superclass  superclass  superclass  superclass  superclass  superclass  superclass  !

self class superclass superclass  superclass  superclass  superclass  superclass  superclass !

self class superclass superclass  superclass  superclass  superclass  superclass !

self class superclass superclass  superclass  superclass  superclass  !

self class superclass superclass  superclass  superclass !

self class superclass superclass  superclass  !

self class superclass superclass  !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:16:34' prior: 50351895 overrides: 16896425!
initialize

! !

SystemWindow subclass: #ShopWebClient
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!

!classDefinition: #ShopWebClient category: 'Tus-Libros-Web-Client' stamp: 'AW 7/1/2021 18:16:44'!
SystemWindow subclass: #ShopWebClient
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:18:25' prior: 50351925 overrides: 50559914!
initialize

	self setLabel: 'Hola don pepito'.
	self openInWorld.
	! !

ShopWebClient new.!
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:20:28' prior: 50351942 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Hola don pepito'.

	self openInWorld.
	! !

ShopWebClient new.!
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:21:36' prior: 50351949 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Compre ya sus libros'.

	self openInWorld.
	! !

!classDefinition: #ShopWebClientModel category: 'Tus-Libros-Web-Client' stamp: 'AW 7/1/2021 18:24:21'!
Object subclass: #ShopWebClientModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:24:17' prior: 50351957 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Compre ya sus libros'.
	self model: ShopWebClientModel new.
	self buildShopWindow.
	

	self openInWorld.
	! !

ShopWebClient new.  !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:25:04'!
buildShopWindow
	self shouldBeImplemented.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:33:27' prior: 50351981!
buildShopWindow
	
	self layoutMorph 
		beColumn;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self build1stRow.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:35:44' prior: 50351986!
buildShopWindow
	
	self layoutMorph 
		beColumn;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self buildUserAndPasswordTextboxRow;
		addMorph: self buildCreateCartButtonRow.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:35:57'!
buildUserAndPasswordTextboxRow
	self shouldBeImplemented.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:36:53' prior: 50352002!
buildUserAndPasswordTextboxRow
	
	
	| layout |
	layout _ LayoutMorph new.
	
	^layout.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:36:58' prior: 50352007!
buildUserAndPasswordTextboxRow
	| layout |
	
	layout _ LayoutMorph new.
	
	^layout.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:37:36' prior: 50352013!
buildUserAndPasswordTextboxRow
	| layout |
	
	layout _ LayoutMorph newRow.
	
	^layout.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:37:48'!
buildCreateCartButtonRow
	self shouldBeImplemented.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:38:14' prior: 50352025!
buildCreateCartButtonRow
	| layout |
	
	layout _ LayoutMorph newRow.
	
	
	^layout .! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:39:35'!
buildCreateCartWindow
	
	self layoutMorph 
		beColumn;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self buildUserAndPasswordTextboxRow;
		addMorph: self buildCreateCartButtonRow.! !
!ShopWebClient methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:39:35' prior: 50351972 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Compre ya sus libros'.
	self model: ShopWebClientModel new.
	self buildCreateCartWindow.
	

	self openInWorld.
	! !

!methodRemoval: ShopWebClient #buildShopWindow stamp: 'AW 7/1/2021 18:39:35'!
buildShopWindow
	
	self layoutMorph 
		beColumn;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self buildUserAndPasswordTextboxRow;
		addMorph: self buildCreateCartButtonRow.!

!classRenamed: #ShopWebClient as: #CreateCartWindow stamp: 'AW 7/1/2021 18:40:03'!
Smalltalk renameClassNamed: #ShopWebClient as: #CreateCartWindow!

!classRenamed: #ShopWebClientModel as: #CreateCartWindowModel stamp: 'AW 7/1/2021 18:40:13'!
Smalltalk renameClassNamed: #ShopWebClientModel as: #CreateCartWindowModel!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:40:13' prior: 50352046 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Compre ya sus libros'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	

	self openInWorld.
	! !

!classDefinition: #CreateCartWindow category: 'Tus-Libros-Web-Client' stamp: 'AW 7/1/2021 18:45:00'!
SystemWindow subclass: #CreateCartWindow
	instanceVariableNames: 'userNameTextBox'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:45:12' prior: 50352019!
buildUserAndPasswordTextboxRow
	| layout |
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox
		"addMorph: passwordTextBox;"
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:46:44' prior: 50352090!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: nil.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox
		"addMorph: passwordTextBox;"
		.
	
	
	^layout.! !

CreateCartWindow new. !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:47:36' prior: 50352100!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: self model.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox
		"addMorph: passwordTextBox;"
		.
	
	
	^layout.! !

CreateCartWindow new. !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:51:39' prior: 50352113!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox
		"addMorph: passwordTextBox;"
		.
	
	
	^layout.! !

CreateCartWindow new.  !

CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:51:55'!
userName
	self shouldBeImplemented.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:52:07' prior: 50352141!
userName
	^'Hola mama'! !

CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:54:50' prior: 50352126!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ].
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox
		"addMorph: passwordTextBox;"
		.
	
	
	^layout.! !

CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:55:04'!
userName: aText 
	self shouldBeImplemented.! !

!classDefinition: #CreateCartWindowModel category: 'Tus-Libros-Web-Client' stamp: 'AW 7/1/2021 18:55:51'!
Object subclass: #CreateCartWindowModel
	instanceVariableNames: 'userName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/1/2021 18:55:49' prior: 50352169!
userName: aUsername 
	userName _ aUsername.! !

----QUIT----(1 July 2021 22:01:05) CuisUniversity-4532.image priorSource: 252576!

----STARTUP---- (1 July 2021 22:04:01) as /home/nikita/r/f/isw1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!

!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:07:45' prior: 50352146!
userName
	^userName! !

CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:08:41' overrides: 16896425!
initialize
	userName _ ''.! !


CreateCartWindow new.  !


CreateCartWindow new.  !


CreateCartWindow new.  !


PluggableMorph new.!


PluggableMorph new.!


PluggableMorph new.!

self openInWorld.!


CreateCartWindow new.  !

!classDefinition: #CreateCartWindow category: 'Tus-Libros-Web-Client' stamp: 'nz 7/1/2021 22:12:39'!
SystemWindow subclass: #CreateCartWindow
	instanceVariableNames: 'userNameTextBox passwordTextBox'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:12:27' prior: 50352151!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ].
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:12:54' prior: 50352219!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ].
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:13:21' prior: 50352236!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ].
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:13:42'!
buildTextBoxMorph

	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ]! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:13:42' prior: 50352253!
buildUserAndPasswordTextboxRow
	| layout |
	
	self buildTextBoxMorph.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:14:04' prior: 50352270!
buildTextBoxMorph

	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ]! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:14:29'!
buildTextBoxMorph: aGetter

	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ]! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:14:29' prior: 50352282!
buildUserAndPasswordTextboxRow
	| layout |
	
	self buildTextBoxMorph: #userName.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !

!methodRemoval: CreateCartWindow #buildTextBoxMorph stamp: 'nz 7/1/2021 22:14:29'!
buildTextBoxMorph

	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ]!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:14:59'!
buildTextBoxMorph: aGetter setter: aSetter 

	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ]! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:14:59' prior: 50352316!
buildUserAndPasswordTextboxRow
	| layout |
	
	self buildTextBoxMorph: #userName setter: #userName:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !

!methodRemoval: CreateCartWindow #buildTextBoxMorph: stamp: 'nz 7/1/2021 22:14:59'!
buildTextBoxMorph: aGetter

	userNameTextBox _ TextModelMorph
		textProvider: self model
		textGetter: #userName
		textSetter: #userName:.
		
	userNameTextBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			userNameTextBox textMorph acceptContents ]!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:15:19' prior: 50352337!
buildTextBoxMorph: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	^textBox.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:15:49' prior: 50352349!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self buildTextBoxMorph: #userName setter: #userName:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:16:04' prior: 50352384!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self buildTextBoxMorph: #userName setter: #userName:.
	passwordTextBox _ self buildTextBoxMorph: #password setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !


CreateCartWindow new.  !


CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:16:19'!
password
	self shouldBeImplemented.! !

!classDefinition: #CreateCartWindowModel category: 'Tus-Libros-Web-Client' stamp: 'nz 7/1/2021 22:16:26'!
Object subclass: #CreateCartWindowModel
	instanceVariableNames: 'userName password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:16:24' prior: 50352412!
password
	password! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:16:49' prior: 50352199 overrides: 16896425!
initialize
	userName _ ''.
	password _ ''.! !


CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:17:32' prior: 50352425!
password
	^ password.! !


CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:18:39' prior: 50352372!
buildTextBoxMorph: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300.
		
	^textBox.! !


CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:19:04' prior: 50352441!
buildTextBoxMorph: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	^textBox.! !


CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:20:06'!
withLabel: aLabel buildTextBoxMorph: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	^textBox.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:20:06' prior: 50352396!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self withLabel: 'asdf' buildTextBoxMorph: #userName setter: #userName:.
	passwordTextBox _ self withLabel: 'asdf' buildTextBoxMorph: #password setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !

!methodRemoval: CreateCartWindow #buildTextBoxMorph:setter: stamp: 'nz 7/1/2021 22:20:06'!
buildTextBoxMorph: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	^textBox.!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:20:28'!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	^textBox.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:20:28' prior: 50352489!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self buildTextBoxMorphwithLabel: 'asdf' getter: #userName setter: #userName:.
	passwordTextBox _ self buildTextBoxMorphwithLabel: 'asdf' getter: #password setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !

!methodRemoval: CreateCartWindow #withLabel:buildTextBoxMorph:setter: stamp: 'nz 7/1/2021 22:20:28'!
withLabel: aLabel buildTextBoxMorph: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	^textBox.!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:20:46' prior: 50352535!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self buildTextBoxMorphwithLabel: 'User Name' getter: #userName setter: #userName:.
	passwordTextBox _ self buildTextBoxMorphwithLabel: 'Password' getter: #password setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:21:06' prior: 50352567!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self
		buildTextBoxMorphwithLabel: 'User Name'
		getter: #userName
		setter: #userName:.
	passwordTextBox _ self
		buildTextBoxMorphwithLabel: 'Password'
		getter: #password
		setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:21:09' prior: 50352583!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self
		buildTextBoxMorphwithLabel: 'User Name'
		getter: #userName
		setter: #userName:.
		
	passwordTextBox _ self
		buildTextBoxMorphwithLabel: 'Password'
		getter: #password
		setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:23:03' prior: 50352600!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self
		buildTextBoxMorphwithLabel: 'User Name'
		getter: #userName
		setter: #userName:.
		
	passwordTextBox _ self
		buildTextBoxMorphwithLabel: 'Password'
		getter: #password
		setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:23:48' prior: 50352519!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
	textBox label: aLabel.
		
	^textBox.! !


CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:24:04' prior: 50352634!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
	textBox	
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
		
	^textBox.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:24:59' prior: 50352652!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 

	| textBox |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
		
	textBox
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
		
	^textBox.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:27:44' prior: 50352668!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 

	| textBox firstRowLayoutMorph |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
		
	textBox
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	firstRowLayoutMorph _ LayoutMorph newRow.
	firstRowLayoutMorph
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: aLabel);
		addMorph: textBox.
	^ firstRowLayoutMorph.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:27:51' prior: 50352684!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 

	| textBox layout |
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
		
	textBox
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: aLabel);
		addMorph: textBox.
	^ layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:27:57' prior: 50352706!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 
	| textBox layout |
	
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
		
	textBox
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: aLabel);
		addMorph: textBox.
	^ layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:28:23'!
buildTextBoxMorphWithLabel: aLabel getter: aGetter setter: aSetter 
	| textBox layout |
	
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
		
	textBox
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: aLabel);
		addMorph: textBox.
	^ layout.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:28:23' prior: 50352617!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self
		buildTextBoxMorphWithLabel: 'User Name'
		getter: #userName
		setter: #userName:.
		
	passwordTextBox _ self
		buildTextBoxMorphWithLabel: 'Password'
		getter: #password
		setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		.
	
	
	^layout.! !

!methodRemoval: CreateCartWindow #buildTextBoxMorphwithLabel:getter:setter: stamp: 'nz 7/1/2021 22:28:23'!
buildTextBoxMorphwithLabel: aLabel getter: aGetter setter: aSetter 
	| textBox layout |
	
	textBox _ TextModelMorph
		textProvider: self model
		textGetter: aGetter
		textSetter: aSetter.
		
	textBox textMorph
		setProperty: #keyStroke:
		toValue: [ :key |
			textBox textMorph acceptContents ].
		
	textBox
		borderWidth: 1;
		borderColor: Color skyBlue;
		morphWidth: 300;
		morphHeight: 20.
		
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: (LabelMorph contents: aLabel);
		addMorph: textBox.
	^ layout.!


CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:29:31' prior: 50352768!
buildUserAndPasswordTextboxRow
	| layout |
	
	userNameTextBox _ self
		buildTextBoxMorphWithLabel: 'User Name'
		getter: #userName
		setter: #userName:.
		
	passwordTextBox _ self
		buildTextBoxMorphWithLabel: 'Password'
		getter: #password
		setter: #password:.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: userNameTextBox;
		addMorph: passwordTextBox.
		
	
	
	^layout.! !


CreateCartWindow new.  !

!classDefinition: #CreateCartWindow category: 'Tus-Libros-Web-Client' stamp: 'nz 7/1/2021 22:31:16'!
SystemWindow subclass: #CreateCartWindow
	instanceVariableNames: 'userNameTextBox passwordTextBox createCartButton'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:31:13' prior: 50352030!
buildCreateCartButtonRow
	| layout |
	
	createCartButton _ PluggableButtonMorph
		model: self model
		stateGetter: nil
		action: #createCartRequest
		label: 'Create Cart'.
	
	layout _ LayoutMorph newRow.
	layout
		separation: 25;
		axisEdgeWeight: 0.5;
		addMorph: createCartButton.
	^layout .! !


CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:31:46'!
createCartRequest
	self shouldBeImplemented.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:31:49' prior: 50352846!
createCartRequest
	! !


CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:32:27' prior: 50352851!
createCartRequest
	
	self inspect! !


CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:32:46'!
password: aText 
	self shouldBeImplemented.
	password _ aText! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:32:51' prior: 50352861!
password: aText 
	password _ aText! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:45:47' prior: 50352073 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Compre ya sus libros'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	
	self openInWorld.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:46:05' prior: 50352872 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Cree su carrito'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	
	self openInWorld.! !


TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.!

!classDefinition: #TusLibrosClient category: 'Tus-Libros-Web-Client' stamp: 'nz 7/1/2021 22:51:55'!
Object subclass: #TusLibrosClient
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:51:44' prior: 50352856!
createCartRequest
	
	| tusLibrosClient |
	tusLibrosClient := TusLibrosClient new.
	tusLibrosClient createCart: userName password: password.
	! !


CreateCartWindow new.  !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 22:54:56'!
createCart: aText password: aText2 
	self shouldBeImplemented.! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:00:12' prior: 50352911!
createCart: aClientId password: aPassword 

	| fieldDict resp |
	fieldDict _ Dictionary new.
	fieldDict at: 'clientId' put: aClientId.
	fieldDict at: 'password' put: aPassword.
	resp _ WebClient
		htmlSubmit: self url, '/createCart'
		fields: fieldDict.
	resp isSuccess
		ifTrue: [ ^ (WebUtils jsonDecode: resp content readStream) asOrderedCollection ]
		ifFalse: [ ^ self error: resp content ].! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:00:18' prior: 50352917!
createCart: aClientId password: aPassword 

	| fieldDict response |
	fieldDict _ Dictionary new.
	fieldDict at: 'clientId' put: aClientId.
	fieldDict at: 'password' put: aPassword.
	response _ WebClient
		htmlSubmit: self url, '/createCart'
		fields: fieldDict.
	response isSuccess
		ifTrue: [ ^ (WebUtils jsonDecode: response content readStream) asOrderedCollection ]
		ifFalse: [ ^ self error: response content ].! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:00:41'!
url
	self shouldBeImplemented.! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:01:06' prior: 50352949!
url
	^'http://localhost:8080'! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:01:08' prior: 50352954!
url
	^'http://localhost:8080'.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:02:23' prior: 50352903!
createCartRequest
	
	| tusLibrosClient response |
	tusLibrosClient := TusLibrosClient new.
	response := tusLibrosClient createCart: userName password: password.
	response inspect.! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:03:19' prior: 50352933!
createCart: aClientId password: aPassword 

	| fieldDict response |
	fieldDict _ Dictionary new.
	fieldDict at: 'clientId' put: aClientId.
	fieldDict at: 'password' put: aPassword.
	response _ WebClient
		htmlSubmit: self url, '/createCart'
		fields: fieldDict.
	response isSuccess
		ifTrue: [ ^WebUtils jsonDecode: response content readStream ]
		ifFalse: [ ^ self error: response content ].! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:03:20' prior: 50352973!
createCart: aClientId password: aPassword 

	| fieldDict response |
	fieldDict _ Dictionary new.
	fieldDict at: 'clientId' put: aClientId.
	fieldDict at: 'password' put: aPassword.
	response _ WebClient
		htmlSubmit: self url, '/createCart'
		fields: fieldDict.
	response isSuccess
		ifTrue: [ ^ WebUtils jsonDecode: response content readStream ]
		ifFalse: [ ^ self error: response content ].! !


CreateCartWindow new.  !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:04:09' prior: 50352964!
createCartRequest
	
	| tusLibrosClient response |
	tusLibrosClient := TusLibrosClient new.
	response := tusLibrosClient createCart: userName password: password.
	self halt.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'nz 7/1/2021 23:07:07' prior: 50353006!
createCartRequest
	
	| tusLibrosClient response |
	tusLibrosClient := TusLibrosClient new.
	response := tusLibrosClient createCart: userName password: password.
	
	self halt.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !

----QUIT----(1 July 2021 23:09:12) CuisUniversity-4532.image priorSource: 657134!

----STARTUP---- (6 July 2021 19:06:29) as /home/awolfsdorf/Dropbox/CSCOM/IngeSoft1/Inge1-ejercicios/20-TusLibros-Iteracion-4/CuisUniversity-4532.image!


!classDefinition: #CreateCartWindowModel category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:13:15'!
Object subclass: #CreateCartWindowModel
	instanceVariableNames: 'userName password tusLibrosClien'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:13:14' prior: 50353015!
createCartRequest
	
	| response |
	response := tusLibrosClien createCart: userName password: password.
	
	self halt.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !

!classDefinition: #CreateCartWindowModel category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:13:23'!
Object subclass: #CreateCartWindowModel
	instanceVariableNames: 'userName password tusLibrosClient'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:13:23' prior: 50353049!
createCartRequest
	
	| response |
	response := tusLibrosClient createCart: userName password: password.
	
	self halt.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:13:31' prior: 50352430 overrides: 16896425!
initialize
	userName _ ''.
	password _ ''.
	tusLibrosClient := TusLibrosClient new.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:15:32' prior: 50353074!
createCartRequest
	
	| response |
	response := tusLibrosClient createCart: userName password: password.
	
	self cart: response.
	
	self halt.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:15:39' prior: 50353097!
createCartRequest
	
	| cartId |
	cartId := tusLibrosClient createCart: userName password: password.
	
	self cart: cartId.
	
	self halt.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:17:23' prior: 50352989!
createCart: aClientId password: aPassword 

	| fieldDict response |
	fieldDict _ Dictionary new.
	fieldDict at: 'clientId' put: aClientId.
	fieldDict at: 'password' put: aPassword.
	response _ WebClient
		htmlSubmit: self url, '/createCart'
		fields: fieldDict.
	self halt.
	response isSuccess
		ifTrue: [ ^ WebUtils jsonDecode: response content readStream ]
		ifFalse: [ ^ self error: response content ].! !


CreateCartWindow new.  !

	response content!

	response content readStream !

(WebUtils jsonDecode: response content readStream) at: 'cartId'!
!TusLibrosClient methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:20:01' prior: 50353131!
createCart: aClientId password: aPassword 

	| fieldDict response |
	fieldDict _ Dictionary new.
	fieldDict at: 'clientId' put: aClientId.
	fieldDict at: 'password' put: aPassword.
	response _ WebClient
		htmlSubmit: self url, '/createCart'
		fields: fieldDict.
	response isSuccess
		ifTrue: [ ^ (WebUtils jsonDecode: response content readStream) at: 'cartId' ]
		ifFalse: [ ^ self error: response content ].
		
! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:20:17'!
cart: aSmallInteger 
	self shouldBeImplemented.! !

!classDefinition: #CreateCartWindowModel category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:21:19'!
Object subclass: #CreateCartWindowModel
	instanceVariableNames: 'userName password tusLibrosClient cartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:21:17' prior: 50353168!
cart: aCartId 
	cartID := aCartId.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:22:00' prior: 50353114!
createCartRequest
	
	self cart: (tusLibrosClient createCart: userName password: password).
	
	self halt.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !

!classDefinition: #CreateCartWindowModel category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:22:09'!
Object subclass: #CreateCartWindowModel
	instanceVariableNames: 'userName password tusLibrosClient cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:22:09' prior: 50353183!
cart: aCartId 
	cartId := aCartId.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:31:22' prior: 50352881 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Cree su carrito'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	
	self model when: #cartCreated send: #navigateToCatalogWindow to: self.
	
	self openInWorld.! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:31:54' prior: 50353188!
createCartRequest
	
	self cart: (tusLibrosClient createCart: userName password: password).
	
	self cartCreated.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:32:39' prior: 50353229!
createCartRequest
	
	self cart: (tusLibrosClient createCart: userName password: password).
	
	self triggerEvent: #cartCreated with: self.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:34:31' prior: 50353245!
createCartRequest
	
	self cart: (tusLibrosClient createCart: userName password: password).
	
	self triggerEvent: self class cartCreatedEvent with: self.
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:35:10' prior: 50353218 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Cree su carrito'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	
	self model when: self model class createdCartEvent send: #navigateToCatalogWindow to: self.
	
	self openInWorld.! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:35:18' prior: 50353280 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Cree su carrito'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	
	self model when: self model class cartCreatedEvent send: #navigateToCatalogWindow to: self.
	
	self openInWorld.! !


CreateCartWindow new.  !
!CreateCartWindowModel class methodsFor: 'events' stamp: 'AW 7/6/2021 19:36:13'!
cartCreatedEvent
	self shouldBeImplemented.! !
!CreateCartWindowModel class methodsFor: 'events' stamp: 'AW 7/6/2021 19:36:18' prior: 50353304!
cartCreatedEvent
	^#cartCreated! !
!CreateCartWindow methodsFor: 'navigation' stamp: 'AW 7/6/2021 19:36:42'!
navigateToCatalogWindow
	self shouldBeImplemented.! !
!CreateCartWindow methodsFor: 'navigation' stamp: 'AW 7/6/2021 19:36:59' prior: 50353313!
navigateToCatalogWindow
	
	"
	Hacer algo para movernos a la pantalla de catalogo
	"! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:40:49' prior: 50353262!
createCartRequest
	[ self cart: (tusLibrosClient createCart: userName password: password).
	  self triggerEvent: self class cartCreatedEvent with: self. ] on: Error
		do: [ self triggerEvent: self class cartCreationErrorEvent ].
		
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindowModel methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:41:05' prior: 50353324!
createCartRequest
	[ self cart: (tusLibrosClient createCart: userName password: password).
	  self triggerEvent: self class cartCreatedEvent with: self. ] on: Error
		do: [ self triggerEvent: self class cartCreationErrorEvent with: self ].
		
	"
	en el caso de que este ok: 
	- actualizar el modelo (guardarnos el id de carrito)
	- tirar un evento avisando que tenemos un carrito 
	en el caso de que falle:
	- tirar un evento con informacion del error
	
	despues:
	- capturar eventos en la vista y actuar en consecencia
	"! !
!CreateCartWindow methodsFor: 'as yet unclassified' stamp: 'AW 7/6/2021 19:43:16' prior: 50353292 overrides: 50559914!
initialize

	super initialize.
	self setLabel: 'Cree su carrito'.
	self model: CreateCartWindowModel new.
	self buildCreateCartWindow.
	
	
	self model when: self model class cartCreatedEvent send: #navigateToCatalogWindow to: self.
	self model when: self model class cartCreationErrorEvent send: #showBadLoginErrorDialog to: self.
	
	self openInWorld.! !


CreateCartWindow new.  !
!CreateCartWindowModel class methodsFor: 'events' stamp: 'AW 7/6/2021 19:43:41'!
cartCreationErrorEvent
	self shouldBeImplemented.! !

CreateCartWindow new.  !
!CreateCartWindowModel class methodsFor: 'events' stamp: 'AW 7/6/2021 19:44:33' prior: 50353380!
cartCreationErrorEvent
	^#cartCreationErrorEvent! !


shopConfiguration _ ShopConfiguration 
		withUserAuthenticator: (stubs mockUserAuthenticatorAlwaysReturning: false)
		prices: stubs priceList
		merchantProcessor: stubs mockAlwaysOkMerchantProcessor
		timeProvider: stubs timeProvider. 
		
TusLibrosRestInterface allInstances do: [ :x | x destroy ].
tusLibrosWebServer _ TusLibrosRestInterface on: 8080 shopConfiguration: shopConfiguration. 
tusLibrosWebServer startListening.
!


CreateCartWindow new.  !
!CreateCartWindow methodsFor: 'dialogs' stamp: 'AW 7/6/2021 19:45:47'!
showBadLoginErrorDialog
	self shouldBeImplemented.! !

self contents: 'Hola'!

MinimalStringMorph contents: 'Hola'!

MinimalStringMorph contents: 'Hola'!

MinimalStringMorph contents: 'Hola'!

MinimalStringMorph contents: 'Hola'!

MinimalStringMorph contents: 'Hola'.!

MinimalStringMorph contents: 'Hola'.!

MinimalStringMorph contents: 'Hola'.!

(MinimalStringMorph contents: 'Hola') openInWorld .!

(MinimalStringMorph contents: 'Hola') openInWorld .!

(MinimalStringMorph contents: 'Hola') openInWorld .!

(MinimalStringMorph contents: 'Hola') openInWorld .!

(MinimalStringMorph contents: 'Hola') openInWorld .!

TextModelMorph withText: 'holis'!

(TextModelMorph withText: 'holis') openInWorld !

SystemWindow subclass: #MessageDialogWindow
	instanceVariableNames: 'message'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!

!classDefinition: #MessageDialogWindow category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:55:11'!
SystemWindow subclass: #MessageDialogWindow
	instanceVariableNames: 'message'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!MessageDialogWindow class methodsFor: 'no messages' stamp: 'AW 7/6/2021 19:56:11'!
message: aMessageText 

	^self new initializeMessage: aMessageText.! !

MessageDialogWindow message: 'holis'!

!classDefinition: #MessageDialogWindow category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:56:56'!
SystemWindow subclass: #MessageDialogWindow
	instanceVariableNames: 'message messageText'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 19:56:56'!
initializeMessage: aMessageText 
	self shouldBeImplemented.
	messageText := aMessageText.! !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 19:57:01' prior: 50353458!
initializeMessage: aMessageText 
	
	messageText := aMessageText.! !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 19:57:54' prior: 50353464!
initializeMessage: aMessageText 
	
	messageText := aMessageText.
	
	self label: aMessageText.
	
	self openInWorld.! !

	MessageDialogWindow message: 'holis' !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 19:58:30' prior: 50353470!
initializeMessage: aMessageText 
	
	self label: aMessageText.
	
	self openInWorld.! !

SystemWindow subclass: #MessageDialogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!

!classDefinition: #MessageDialogWindow category: 'Tus-Libros-Web-Client' stamp: 'AW 7/6/2021 19:58:38'!
SystemWindow subclass: #MessageDialogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tus-Libros-Web-Client'!
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 19:58:49' prior: 50353478!
initializeMessage: aMessageText 
	
	self setLabel: aMessageText.
	
	self openInWorld.! !

	MessageDialogWindow message: 'holis' !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:01:49' prior: 50353497!
initializeMessage: aMessageText 
	
	self setLabel: aMessageText.
	self morphExtent: self defaultExtent
	self openInWorld.! !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:02:05'!
defaultExtent
	^200@200! !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:02:14' prior: 50353505!
initializeMessage: aMessageText 
	
	self setLabel: aMessageText.
	self morphExtent: self defaultExtent.
	self openInWorld.
	! !

(MessageDialogWindow message: 'HOlis') openInWorld !

(MessageDialogWindow message: 'HOlis') !

(MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:03:11' prior: 50353512!
defaultExtent
	^20@20! !

	(MessageDialogWindow message: 'HOlis') !

	self initialExtent !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:05:33' overrides: 16926571!
initialExtent 
	self defaultExtent.
	! !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:05:38' prior: 50353534 overrides: 16926571!
initialExtent 
	^self defaultExtent.
	! !

	(MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:06:05' prior: 50353539 overrides: 16926571!
initialExtent 
	^200@200.
	
! !

	(MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:07:10' prior: 50353546 overrides: 16926571!
initialExtent 
	^100@200.
	 
! !

	 (MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:07:22' prior: 50353552 overrides: 16926571!
initialExtent 
	^200@100.

! !

	 (MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:07:56' prior: 50353559 overrides: 16926571!
initialExtent 
	^300@0.


! !

	 (MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:08:17' prior: 50353565 overrides: 16926571!
initialExtent 
	^500@0.


! !

	 (MessageDialogWindow message: 'HOlis') !
!MessageDialogWindow methodsFor: 'initialization' stamp: 'AW 7/6/2021 20:08:29' prior: 50353571 overrides: 16926571!
initialExtent 
	^500@0.
! !
!CreateCartWindow methodsFor: 'dialogs' stamp: 'AW 7/6/2021 20:09:23' prior: 50353405!
showBadLoginErrorDialog
	MessageDialogWindow message: 'Login Invlido!!'.! !

CreateCartWindow new.  !

----QUIT----(6 July 2021 20:14:25) CuisUniversity-4532.image priorSource: 684201!